<!DOCTYPE html>

<html>

<head lang="en">

    <meta charset="UTF-8">

    <title>Company</title>

</head>

<body>

<script type="text/javascript">

var offices = [

{ id: "GD", name: "Gdańsk", headquarter: true },

{ id: "GL", name: "Gliwice" },

{ id: "KO", name: "Koszalin" }

];



var workers = [

{ id: 1,  name: "Bartek",     type: "P", office: "GD", salary: 300 },

{ id: 2,  name: "Wojtek",     type: "P", office: "GD", salary: 210 },

{ id: 3,  name: "Piotr",      type: "M", office: "GL", salary: 250 },

{ id: 4,  name: "Damian",     type: "P", office: "KO", salary: 290 },

{ id: 5,  name: "Jan",        type: "P", office: "GL", salary: 210 },

{ id: 6,  name: "Mateusz",    type: "P", office: "GD", salary: 290 },

{ id: 7,  name: "Weronika",   type: "M", office: "KO", salary: 240 },

{ id: 8,  name: "Gabriela",   type: "M", office: "GD", salary: 290 },

{ id: 9,  name: "Alina",      type: "M", office: "KO", salary: 290 },

{ id: 10, name: "Aleksander", type: "P", office: "GL", salary: 260 },

{ id: 11, name: "Tomek",      type: "P", office: "GD", salary: 200 },

{ id: 12, name: "Krzysztof",  type: "M", office: "KO", salary: 290 },

{ id: 13, name: "Marcin",     type: "P", office: "GD", salary: 280 },

{ id: 14, name: "Agata",      type: "P", office: "GD", salary: 230 },

{ id: 15, name: "Magda",      type: "P", office: "KO", salary: 220 }

];
//TODO company miało mieć klucz offices i w nim listę a nie być tą listą
var Company = offices.map(newOffices => newOffices);

for (var i = 0; i < Company.length; i++) {
    Company[i].workers = [];
}
//TODO tego fora można już było zrobić w mapie

var workersGd = workers
    .filter(Gda => Gda.office === "GD");

var workersGl = workers
    .filter(Gli => Gli.office === "GL");

var workersKo = workers
    .filter(Kos => Kos.office === "KO");

//TODO wyszukiwanie po indexie nie ejst dobry pomysłem
var addWorkersGd = Company[0].workers;
    addWorkersGd.push(workersGd);

var addWorkersGl = Company[1].workers;
    addWorkersGl.push(workersGl);

var addWorkersKo = Company[2].workers;
    addWorkersKo.push(workersKo);

var officeGl = Company.filter(officeGli => officeGli.name === "Gliwice");

var newOffice = { id: "PO", name: "Poznań"};
    Company.push(newOffice);

var workersPo = [{ id: 16, name: "Olek", type: "M", office: "PO", salary: 500 }];
//TODO wyszukiwanie po indexie nie ejst dobry pomysłem
    Company[3].workers = [];
var addWorkersPo = Company[3].workers;
    addWorkersPo.push(workersPo);

var officePo = Company
    .filter(officePoz => officePoz.name === "Poznań");
    
var allWorkers = Company
    .map(allWorkers => allWorkers.workers)
    .reduce((acc, allWorkersFixed) => acc.concat(allWorkersFixed))
    .reduce((acc, allWorkersFixed) => acc.concat(allWorkersFixed))

var allSalaries = allWorkers
    .map(worker => worker.salary)
    
var salarySum = allSalaries
    .reduce((acc, salary) => acc + salary)
    
var numberOfWorkers = allWorkers
    .length

var averageSalary = salarySum / numberOfWorkers;

var gdanskSalaries = workersGd
    .map(worker => worker.salary)

var largestSalaryGd = Math.max.apply(null, gdanskSalaries);

var mostPayedWorkerInGd = workersGd
    .filter(workers => workers.salary === largestSalaryGd)

var gliwiceSalaries = workersGl
    .map(worker => worker.salary)

var largestSalaryGl = Math.max.apply(null, gliwiceSalaries);

var mostPayedWorkerInGl = workersGl
    .filter(workers => workers.salary === largestSalaryGl)

var koszalinSalaries = workersKo
    .map(worker => worker.salary)

var largestSalaryKo = Math.max.apply(null, koszalinSalaries);
//TODO tutaj wsyztsko powtarzasz -> można zrobić funckję

var mostPayedWorkerInKo = workersKo
    .filter(workers => workers.salary === largestSalaryKo)

var poznanSalaries = workersPo
    .map(worker => worker.salary)

var largestSalaryPo = Math.max.apply(null, poznanSalaries);

var mostPayedWorkerInPo = workersPo
    .filter(workers => workers.salary === largestSalaryPo)

var largestSalary = Math.max.apply(null, allSalaries);

var mostPayedWorkerInCompany = allWorkers
    .filter(workers => workers.salary === largestSalary)

console.log(Company);
console.log(officeGl);
console.log(officePo);
console.log(averageSalary);
console.log(mostPayedWorkerInGd);
console.log(mostPayedWorkerInGl);
console.log(mostPayedWorkerInKo);
console.log(mostPayedWorkerInPo);
console.log(mostPayedWorkerInCompany);
</script>

</body>

</html>
